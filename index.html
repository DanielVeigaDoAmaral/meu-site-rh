                import React, { useState, useEffect } from 'react';
import { initializeApp } from 'firebase/app';
import { 
  getAuth, 
  signInWithCustomToken, 
  signInAnonymously, 
  onAuthStateChanged,
  createUserWithEmailAndPassword,
  signInWithEmailAndPassword,
  signOut
} from 'firebase/auth';
import { 
  getFirestore, 
  doc, 
  setDoc, 
  getDoc, 
  collection, 
  onSnapshot, 
  addDoc, 
  updateDoc, 
  deleteDoc,
  query
} from 'firebase/firestore';
import { 
  User, 
  Building2, 
  Users, 
  FileText, 
  History, 
  LogOut, 
  Printer, 
  Plus, 
  Trash2, 
  DollarSign, 
  Calculator,
  Calendar
} from 'lucide-react';

// Firebase Configuration
const firebaseConfig = JSON.parse(__firebase_config);
const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);
const appId = typeof __app_id !== 'undefined' ? __app_id : 'folha-metalurgica-v4';

const SALARIO_MINIMO = 1518.00;

export default function App() {
  const [user, setUser] = useState(null);
  const [authMode, setAuthMode] = useState('login'); // 'login' | 'register'
  const [email, setEmail] = useState('');
  const [password, setPassword] = useState('');
  const [activeTab, setActiveTab] = useState('func');
  const [loading, setLoading] = useState(true);

  // App State
  const [empresa, setEmpresa] = useState({ nome: '', cnpj: '', endereco: '' });
  const [funcionarios, setFuncionarios] = useState([]);
  const [historico, setHistorico] = useState([]);
  
  // UI State
  const [isFuncModalOpen, setIsFuncModalOpen] = useState(false);
  const [editingFunc, setEditingFunc] = useState(null);
  const [mesReferencia, setMesReferencia] = useState(new Date().toISOString().slice(0, 7));
  const [tipoFolha, setTipoFolha] = useState('mensal'); // 'mensal' | 'quinzena'

  // 1. Auth Logic
  useEffect(() => {
    const initAuth = async () => {
      if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
        await signInWithCustomToken(auth, __initial_auth_token);
      }
    };
    initAuth();
    const unsubscribe = onAuthStateChanged(auth, (u) => {
      setUser(u);
      setLoading(false);
    });
    return () => unsubscribe();
  }, []);

  // 2. Data Sync Logic (Firestore)
  useEffect(() => {
    if (!user) return;

    // Sync Empresa
    const unsubEmp = onSnapshot(doc(db, 'artifacts', appId, 'users', user.uid, 'settings', 'empresa'), (doc) => {
      if (doc.exists()) setEmpresa(doc.data());
    }, (err) => console.error("Erro empresa:", err));

    // Sync Funcionarios
    const qFunc = collection(db, 'artifacts', appId, 'users', user.uid, 'funcionarios');
    const unsubFunc = onSnapshot(qFunc, (snap) => {
      setFuncionarios(snap.docs.map(d => ({ id: d.id, ...d.data() })));
    }, (err) => console.error("Erro func:", err));

    // Sync Historico
    const qHist = collection(db, 'artifacts', appId, 'users', user.uid, 'historico');
    const unsubHist = onSnapshot(qHist, (snap) => {
      setHistorico(snap.docs.map(d => ({ id: d.id, ...d.data() })));
    }, (err) => console.error("Erro hist:", err));

    return () => {
      unsubEmp();
      unsubFunc();
      unsubHist();
    };
  }, [user]);

  // Handlers
  const handleAuth = async (e) => {
    e.preventDefault();
    try {
      if (authMode === 'register') {
        await createUserWithEmailAndPassword(auth, email, password);
      } else {
        await signInWithEmailAndPassword(auth, email, password);
      }
    } catch (err) {
      alert("Erro na autenticação: " + err.message);
    }
  };

  const saveEmpresa = async (e) => {
    e.preventDefault();
    if (!user) return;
    await setDoc(doc(db, 'artifacts', appId, 'users', user.uid, 'settings', 'empresa'), empresa);
    alert("Dados da empresa salvos com sucesso!");
  };

  const saveFunc = async (e) => {
    e.preventDefault();
    if (!user) return;
    const formData = new FormData(e.target);
    const data = {
      nome: formData.get('nome').toUpperCase(),
      cargo: formData.get('cargo').toUpperCase(),
      cbo: formData.get('cbo'),
      salario: parseFloat(formData.get('salario')),
      admissao: formData.get('admissao'),
      insalubridade: formData.get('insalubridade') === 'on'
    };

    if (editingFunc) {
      await updateDoc(doc(db, 'artifacts', appId, 'users', user.uid, 'funcionarios', editingFunc.id), data);
    } else {
      await addDoc(collection(db, 'artifacts', appId, 'users', user.uid, 'funcionarios'), data);
    }
    setIsFuncModalOpen(false);
    setEditingFunc(null);
  };

  const processarFolha = async (func, index) => {
    if (!user) return;
    
    const hExStr = document.getElementById(`hex-${func.id}`).value || "00:00";
    const hFaStr = document.getElementById(`hfa-${func.id}`).value || "00:00";
    const descEmp = parseFloat(document.getElementById(`emp-${func.id}`).value) || 0;

    const [hE, mE] = hExStr.split(':').map(Number);
    const decExtra = hE + (mE/60);
    const [hF, mF] = hFaStr.split(':').map(Number);
    const decFalta = hF + (mF/60);

    const valHora = func.salario / 220;
    const vExtra = decExtra * valHora * 1.5;
    const vDsr = (vExtra / 25) * 5;
    const vInsal = func.insalubridade ? (SALARIO_MINIMO * 0.20) : 0;
    const vFalta = decFalta * valHora;

    let vAdiantamento = 0;
    if (tipoFolha === 'mensal') {
      const jaPago = historico.find(h => h.funcId === func.id && h.mes === mesReferencia && h.tipo === 'quinzena');
      if (jaPago) vAdiantamento = jaPago.proventos;
    }

    const proventos = tipoFolha === 'quinzena' ? (func.salario * 0.40) : (func.salario + vExtra + vDsr + vInsal);
    
    let inss = 0;
    if (tipoFolha === 'mensal') {
      const baseInss = proventos - vFalta;
      if (baseInss <= 1518) inss = baseInss * 0.075;
      else if (baseInss <= 2793) inss = (baseInss * 0.09) - 22.77;
      else inss = (baseInss * 0.12) - 106.56;
    }

    const descontos = inss + vFalta + vAdiantamento + descEmp;

    const registro = {
      funcId: func.id,
      nome: func.nome,
      cargo: func.cargo,
      mes: mesReferencia,
      tipo: tipoFolha,
      proventos,
      descontos,
      liquido: proventos - descontos,
      detalhes: { vExtra, vDsr, vInsal, vFalta, inss, vAdiantamento, descEmp, hExStr, hFaStr },
      timestamp: Date.now()
    };

    await addDoc(collection(db, 'artifacts', appId, 'users', user.uid, 'historico'), registro);
    alert(`Folha de ${func.nome} gravada!`);
  };

  const printHolerite = (h) => {
    const win = window.open('', '_blank');
    const func = funcionarios.find(f => f.id === h.funcId) || {};
    
    win.document.write(`
      <html>
        <head>
          <title>Holerite - ${h.nome}</title>
          <script src="https://cdn.tailwindcss.com"></script>
          <style>
            @media print { .no-print { display: none; } }
            body { font-family: sans-serif; }
          </style>
        </head>
        <body class="p-10">
          <div class="border-2 border-black p-6 max-w-3xl mx-auto">
            <div class="flex justify-between border-b-2 border-black pb-4 mb-4">
              <div>
                <h1 class="font-bold text-lg">${empresa.nome || 'NOME DA EMPRESA'}</h1>
                <p class="text-sm">CNPJ: ${empresa.cnpj}</p>
                <p class="text-sm">${empresa.endereco}</p>
              </div>
              <div class="text-right">
                <h2 class="font-bold uppercase">${h.tipo === 'quinzena' ? 'Recibo de Adiantamento' : 'Recibo de Pagamento'}</h2>
                <p class="text-sm">Referência: ${h.mes}</p>
              </div>
            </div>

            <div class="grid grid-cols-3 gap-4 mb-4 text-sm border-b pb-4">
              <div><b>Funcionário:</b> ${h.nome}</div>
              <div><b>Cargo:</b> ${h.cargo}</div>
              <div><b>Admissão:</b> ${func.admissao || '--'}</div>
            </div>

            <table class="w-full text-sm mb-10">
              <thead>
                <tr class="border-b-2 border-black">
                  <th class="text-left py-2">Descrição</th>
                  <th class="text-center">Ref.</th>
                  <th class="text-right">Proventos</th>
                  <th class="text-right">Descontos</th>
                </tr>
              </thead>
              <tbody>
                ${h.tipo === 'quinzena' ? `
                  <tr>
                    <td class="py-1">Adiantamento Quinzenal (40%)</td>
                    <td class="text-center">40%</td>
                    <td class="text-right">${h.proventos.toLocaleString('pt-BR', {minimumFractionDigits: 2})}</td>
                    <td class="text-right">0,00</td>
                  </tr>
                ` : `
                  <tr><td class="py-1">Salário Base</td><td class="text-center">30d</td><td class="text-right">${(h.proventos - h.detalhes.vExtra - h.detalhes.vDsr - h.detalhes.vInsal).toLocaleString('pt-BR', {minimumFractionDigits: 2})}</td><td class="text-right">0,00</td></tr>
                  ${h.detalhes.vInsal > 0 ? `<tr><td class="py-1">Insalubridade</td><td class="text-center">20%</td><td class="text-right">${h.detalhes.vInsal.toLocaleString('pt-BR')}</td><td></td></tr>` : ''}
                  ${h.detalhes.vExtra > 0 ? `<tr><td class="py-1">Horas Extras 50%</td><td class="text-center">${h.detalhes.hExStr}</td><td class="text-right">${h.detalhes.vExtra.toLocaleString('pt-BR')}</td><td></td></tr>` : ''}
                  ${h.detalhes.vDsr > 0 ? `<tr><td class="py-1">DSR s/ Extras</td><td class="text-center"></td><td class="text-right">${h.detalhes.vDsr.toLocaleString('pt-BR')}</td><td></td></tr>` : ''}
                  ${h.detalhes.inss > 0 ? `<tr><td class="py-1">INSS</td><td></td><td></td><td class="text-right">${h.detalhes.inss.toLocaleString('pt-BR')}</td></tr>` : ''}
                  ${h.detalhes.vAdiantamento > 0 ? `<tr><td class="py-1">Desc. Adiantamento</td><td></td><td></td><td class="text-right">${h.detalhes.vAdiantamento.toLocaleString('pt-BR')}</td></tr>` : ''}
                  ${h.detalhes.descEmp > 0 ? `<tr><td class="py-1">Empréstimo CLT</td><td></td><td></td><td class="text-right">${h.detalhes.descEmp.toLocaleString('pt-BR')}</td></tr>` : ''}
                `}
              </tbody>
            </table>

            <div class="flex justify-between items-end">
              <div class="bg-black text-white p-4 font-bold text-xl">
                LÍQUIDO: R$ ${h.liquido.toLocaleString('pt-BR', {minimumFractionDigits: 2})}
              </div>
              <div class="text-center border-t border-black pt-2 w-64 text-xs">
                Assinatura do Funcionário
              </div>
            </div>
            <button class="no-print mt-10 bg-blue-600 text-white p-2 rounded" onclick="window.print()">Imprimir Agora</button>
          </div>
        </body>
      </html>
    `);
  };

  if (loading) return <div className="flex h-screen items-center justify-center font-bold">Iniciando Sistema Seguro...</div>;

  if (!user) {
    return (
      <div className="min-h-screen bg-slate-100 flex items-center justify-center p-4">
        <div className="bg-white p-8 rounded-3xl shadow-2xl w-full max-w-md border border-slate-200">
          <div className="flex justify-center mb-6">
            <div className="bg-blue-600 p-4 rounded-2xl text-white shadow-lg">
              <Building2 size={40} />
            </div>
          </div>
          <h1 className="text-2xl font-black text-center text-slate-800 mb-2 uppercase italic tracking-tighter">
            Metalurgica <span className="text-blue-600">Pro</span>
          </h1>
          <p className="text-center text-slate-400 text-xs font-bold uppercase mb-8">Gestão de Folha Multi-Empresa</p>
          
          <form onSubmit={handleAuth} className="space-y-4">
            <div>
              <label className="text-[10px] font-black uppercase text-slate-400 block mb-1">E-mail Corporativo</label>
              <input 
                type="email" required 
                className="w-full p-3 bg-slate-50 border rounded-xl outline-none focus:ring-2 ring-blue-500 font-bold"
                value={email} onChange={e => setEmail(e.target.value)}
              />
            </div>
            <div>
              <label className="text-[10px] font-black uppercase text-slate-400 block mb-1">Senha de Acesso</label>
              <input 
                type="password" required 
                className="w-full p-3 bg-slate-50 border rounded-xl outline-none focus:ring-2 ring-blue-500 font-bold"
                value={password} onChange={e => setPassword(e.target.value)}
              />
            </div>
            <button className="w-full bg-blue-600 text-white p-4 rounded-xl font-black uppercase tracking-widest hover:bg-blue-700 transition shadow-lg shadow-blue-200">
              {authMode === 'login' ? 'Entrar no Sistema' : 'Criar minha Conta'}
            </button>
          </form>
          
          <button 
            onClick={() => setAuthMode(authMode === 'login' ? 'register' : 'login')}
            className="w-full mt-6 text-xs font-bold text-slate-400 uppercase hover:text-blue-600 transition"
          >
            {authMode === 'login' ? 'Não tem conta? Cadastre sua empresa' : 'Já sou cliente? Faça login'}
          </button>
        </div>
      </div>
    );
  }

  return (
    <div className="min-h-screen bg-slate-50 flex flex-col md:flex-row">
      {/* Sidebar Nav */}
      <nav className="w-full md:w-64 bg-slate-900 text-white p-6 flex flex-col">
        <div className="mb-10">
          <h2 className="text-xl font-black italic tracking-tighter text-blue-400">M-PRO <span className="text-white text-xs">v4.0</span></h2>
          <p className="text-[8px] font-bold text-slate-500 uppercase">{empresa.nome || 'Empresa Nova'}</p>
        </div>

        <div className="space-y-2 flex-1">
          {[
            { id: 'func', label: 'Funcionários', icon: Users },
            { id: 'folha', label: 'Lançar Folha', icon: DollarSign },
            { id: 'hist', label: 'Histórico', icon: History },
            { id: 'config', label: 'Configurações', icon: Building2 },
          ].map(item => (
            <button
              key={item.id}
              onClick={() => setActiveTab(item.id)}
              className={`w-full flex items-center gap-3 p-3 rounded-xl text-xs font-bold transition ${activeTab === item.id ? 'bg-blue-600 text-white shadow-lg' : 'text-slate-400 hover:bg-slate-800'}`}
            >
              <item.icon size={18} /> {item.label.toUpperCase()}
            </button>
          ))}
        </div>

        <button 
          onClick={() => signOut(auth)}
          className="mt-auto flex items-center gap-3 p-3 text-xs font-bold text-red-400 hover:bg-red-500/10 rounded-xl transition"
        >
          <LogOut size={18} /> SAIR DO SISTEMA
        </button>
      </nav>

      {/* Content Area */}
      <main className="flex-1 p-4 md:p-8 overflow-y-auto">
        
        {activeTab === 'config' && (
          <div className="max-w-2xl bg-white p-8 rounded-3xl shadow-sm border border-slate-200">
            <h3 className="text-xl font-black text-slate-800 mb-6 uppercase italic">Dados da Empresa</h3>
            <form onSubmit={saveEmpresa} className="space-y-4">
              <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div className="md:col-span-2">
                  <label className="text-[10px] font-bold text-slate-400 uppercase mb-1 block">Razão Social</label>
                  <input 
                    type="text" className="w-full p-3 bg-slate-50 border rounded-xl outline-none"
                    value={empresa.nome} onChange={e => setEmpresa({...empresa, nome: e.target.value.toUpperCase()})}
                  />
                </div>
                <div>
                  <label className="text-[10px] font-bold text-slate-400 uppercase mb-1 block">CNPJ</label>
                  <input 
                    type="text" className="w-full p-3 bg-slate-50 border rounded-xl outline-none"
                    value={empresa.cnpj} onChange={e => setEmpresa({...empresa, cnpj: e.target.value})}
                  />
                </div>
                <div className="md:col-span-2">
                  <label className="text-[10px] font-bold text-slate-400 uppercase mb-1 block">Endereço Completo</label>
                  <input 
                    type="text" className="w-full p-3 bg-slate-50 border rounded-xl outline-none"
                    value={empresa.endereco} onChange={e => setEmpresa({...empresa, endereco: e.target.value.toUpperCase()})}
                  />
                </div>
              </div>
              <button className="bg-blue-600 text-white px-8 py-3 rounded-xl font-bold uppercase text-xs hover:bg-blue-700 transition">Atualizar Dados</button>
            </form>
          </div>
        )}

        {activeTab === 'func' && (
          <div>
            <div className="flex justify-between items-center mb-6">
              <h3 className="text-xl font-black text-slate-800 uppercase italic">Corpo de Funcionários</h3>
              <button 
                onClick={() => { setEditingFunc(null); setIsFuncModalOpen(true); }}
                className="bg-slate-900 text-white px-6 py-2 rounded-full text-xs font-bold hover:bg-blue-600 transition flex items-center gap-2"
              >
                <Plus size={16} /> NOVO COLABORADOR
              </button>
            </div>

            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
              {funcionarios.map(f => (
                <div key={f.id} className="bg-white p-5 rounded-3xl shadow-sm border border-slate-200 hover:border-blue-200 transition">
                  <div className="flex justify-between items-start mb-4">
                    <div>
                      <h4 className="font-black text-slate-800 tracking-tight leading-none mb-1">{f.nome}</h4>
                      <p className="text-[9px] font-bold text-blue-600 uppercase">{f.cargo}</p>
                    </div>
                    <div className="flex gap-2">
                      <button onClick={() => { setEditingFunc(f); setIsFuncModalOpen(true); }} className="text-slate-300 hover:text-blue-600"><FileText size={16}/></button>
                      <button onClick={async () => { if(confirm("Remover funcionário?")) await deleteDoc(doc(db, 'artifacts', appId, 'users', user.uid, 'funcionarios', f.id)) }} className="text-slate-300 hover:text-red-500"><Trash2 size={16}/></button>
                    </div>
                  </div>
                  <div className="flex justify-between items-center pt-4 border-t">
                    <span className="text-[10px] text-slate-400 font-bold uppercase">Base Salarial</span>
                    <span className="font-black text-slate-800">R$ {f.salario.toLocaleString('pt-BR')}</span>
                  </div>
                </div>
              ))}
            </div>
          </div>
        )}

        {activeTab === 'folha' && (
          <div className="bg-white p-8 rounded-3xl shadow-sm border border-slate-200">
            <div className="flex flex-col md:flex-row justify-between items-end mb-8 gap-4 border-b pb-6">
              <div>
                <h3 className="text-xl font-black text-slate-800 uppercase italic mb-1">Cálculo de Folha</h3>
                <p className="text-[10px] font-bold text-slate-400 uppercase">Selecione o período e o tipo de holerite</p>
              </div>
              <div className="flex gap-4">
                <select 
                  className="p-3 bg-slate-50 border rounded-xl font-bold text-xs outline-none"
                  value={tipoFolha} onChange={e => setTipoFolha(e.target.value)}
                >
                  <option value="mensal">MENSAL (FINAL DO MÊS)</option>
                  <option value="quinzena">ADIANTAMENTO (QUINZENA)</option>
                </select>
                <input 
                  type="month" className="p-3 bg-slate-50 border rounded-xl font-bold text-xs"
                  value={mesReferencia} onChange={e => setMesReferencia(e.target.value)}
                />
              </div>
            </div>

            <div className="overflow-x-auto">
              <table className="w-full text-left text-xs font-bold uppercase">
                <thead className="text-slate-400 border-b">
                  <tr>
                    <th className="py-4 px-2">Colaborador</th>
                    <th className="py-4 px-2">Extras</th>
                    <th className="py-4 px-2">Faltas</th>
                    <th className="py-4 px-2">Empréstimo CLT</th>
                    <th className="py-4 px-2 text-center">Ações</th>
                  </tr>
                </thead>
                <tbody>
                  {funcionarios.map((f, idx) => (
                    <tr key={f.id} className="border-b hover:bg-slate-50 transition">
                      <td className="py-4 px-2">
                        <div>{f.nome}</div>
                        <div className="text-[8px] text-blue-600">Base: R$ {f.salario}</div>
                      </td>
                      <td className="py-4 px-2"><input type="time" id={`hex-${f.id}`} className="p-2 border rounded-lg w-20 outline-none" disabled={tipoFolha === 'quinzena'} /></td>
                      <td className="py-4 px-2"><input type="time" id={`hfa-${f.id}`} className="p-2 border rounded-lg w-20 outline-none" disabled={tipoFolha === 'quinzena'} /></td>
                      <td className="py-4 px-2"><input type="number" id={`emp-${f.id}`} className="p-2 border rounded-lg w-28 outline-none" placeholder="R$ 0,00" /></td>
                      <td className="py-4 px-2 text-center">
                        <button 
                          onClick={() => processarFolha(f, idx)}
                          className="bg-blue-600 text-white px-4 py-2 rounded-xl text-[10px] hover:bg-slate-900 transition shadow-lg shadow-blue-100"
                        >
                          GRAVAR
                        </button>
                      </td>
                    </tr>
                  ))}
                </tbody>
              </table>
            </div>
          </div>
        )}

        {activeTab === 'hist' && (
          <div className="bg-white p-8 rounded-3xl shadow-sm border border-slate-200">
             <h3 className="text-xl font-black text-slate-800 mb-6 uppercase italic">Histórico de Emissões</h3>
             <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                {historico.sort((a,b) => b.timestamp - a.timestamp).map(h => (
                  <div key={h.id} className="border p-5 rounded-2xl relative group">
                    <div className="flex justify-between mb-4">
                      <span className={`text-[8px] font-black px-2 py-1 rounded uppercase ${h.tipo === 'quinzena' ? 'bg-orange-100 text-orange-600' : 'bg-blue-100 text-blue-600'}`}>
                        {h.tipo} • {h.mes}
                      </span>
                      <button onClick={() => printHolerite(h)} className="text-slate-400 hover:text-blue-600 transition">
                        <Printer size={18} />
                      </button>
                    </div>
                    <h5 className="font-bold text-slate-800 text-sm mb-4">{h.nome}</h5>
                    <div className="flex justify-between items-end border-t pt-4">
                      <span className="text-[10px] text-slate-400 uppercase font-bold">Líquido</span>
                      <span className="text-lg font-black text-slate-900">R$ {h.liquido.toLocaleString('pt-BR', {minimumFractionDigits:2})}</span>
                    </div>
                    <button 
                      onClick={async () => { if(confirm("Deletar holerite?")) await deleteDoc(doc(db, 'artifacts', appId, 'users', user.uid, 'historico', h.id)) }}
                      className="absolute top-2 right-2 text-red-300 opacity-0 group-hover:opacity-100 transition"
                    >
                      <Trash2 size={12}/>
                    </button>
                  </div>
                ))}
             </div>
          </div>
        )}

      </main>

      {/* Modal Funcionario */}
      {isFuncModalOpen && (
        <div className="fixed inset-0 bg-slate-900/60 backdrop-blur-sm flex items-center justify-center p-4 z-50">
          <div className="bg-white w-full max-w-lg rounded-3xl shadow-2xl p-8 border border-white">
            <h4 className="text-xl font-black text-slate-800 mb-6 uppercase italic">{editingFunc ? 'Editar Dados' : 'Novo Funcionário'}</h4>
            <form onSubmit={saveFunc} className="space-y-4">
              <div className="grid grid-cols-2 gap-4">
                <div className="col-span-2">
                  <label className="text-[10px] font-black text-slate-400 uppercase mb-1 block">Nome Completo</label>
                  <input name="nome" required defaultValue={editingFunc?.nome} className="w-full p-3 bg-slate-50 border rounded-xl font-bold uppercase" />
                </div>
                <div>
                  <label className="text-[10px] font-black text-slate-400 uppercase mb-1 block">Função / Cargo</label>
                  <input name="cargo" required defaultValue={editingFunc?.cargo} className="w-full p-3 bg-slate-50 border rounded-xl font-bold uppercase" />
                </div>
                <div>
                  <label className="text-[10px] font-black text-slate-400 uppercase mb-1 block">CBO</label>
                  <input name="cbo" defaultValue={editingFunc?.cbo} className="w-full p-3 bg-slate-50 border rounded-xl font-bold" />
                </div>
                <div>
                  <label className="text-[10px] font-black text-slate-400 uppercase mb-1 block">Salário Base</label>
                  <input name="salario" type="number" step="0.01" required defaultValue={editingFunc?.salario} className="w-full p-3 bg-slate-50 border rounded-xl font-bold text-blue-600" />
                </div>
                <div>
                  <label className="text-[10px] font-black text-slate-400 uppercase mb-1 block">Data Admissão</label>
                  <input name="admissao" type="date" required defaultValue={editingFunc?.admissao} className="w-full p-3 bg-slate-50 border rounded-xl font-bold" />
                </div>
                <div className="col-span-2 flex items-center gap-3 bg-slate-50 p-3 rounded-xl border">
                  <input type="checkbox" name="insalubridade" defaultChecked={editingFunc?.insalubridade} className="w-5 h-5 accent-blue-600" />
                  <label className="text-xs font-bold uppercase text-slate-600">Recebe Adicional de Insalubridade (20%)</label>
                </div>
              </div>
              <div className="flex gap-2 pt-4">
                <button className="flex-1 bg-blue-600 text-white p-4 rounded-xl font-black uppercase tracking-widest hover:bg-blue-700 transition">Salvar Colaborador</button>
                <button type="button" onClick={() => setIsFuncModalOpen(false)} className="px-6 text-slate-400 font-bold uppercase text-xs">Cancelar</button>
              </div>
            </form>
          </div>
        </div>
      )}
    </div>
  );
}

